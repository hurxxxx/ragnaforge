# Ragnaforge Development TODO

## 🚀 현재 우선순위 작업

### 🔶 HIGH PRIORITY

#### 1. 🕷️ URL 크롤링 시스템
- [ ] `POST /v1/crawl/url` - URL 기반 문서 수집 API
- [ ] 다중 파일 형식 지원 (웹페이지, PDF, 이미지, Office)
- [ ] 자동 텍스트 추출 및 벡터화
- [ ] 크롤링 작업 관리 및 상태 추적

#### 2. 🗄️ 고급 데이터 관리
- [x] **중복 문서 관리** - 파일 해시 기반 중복 검사 구현 완료
- [x] **Rerank 시스템** - Cross-encoder 기반 재순위화 구현 완료
- [ ] 문서 CRUD API 확장
- [ ] 문서 목록 및 필터링
- [ ] 문서 삭제 및 업데이트
- [ ] 벡터 인덱스 관리
- [ ] 메타데이터 고급 검색

### 🔶 MEDIUM PRIORITY

#### 4. 📈 모니터링 & 분석 확장
- [ ] 검색 성능 메트릭 수집
- [ ] 사용량 분석 대시보드
- [ ] 에러 모니터링 및 알림
- [ ] 시스템 리소스 모니터링
- [ ] 검색 품질 메트릭

#### 5. ⚙️ 설정 시스템 확장
- [ ] Rerank 모델 설정 추가
- [ ] 하이브리드 검색 가중치 설정
- [ ] 환경별 설정 분리 (dev/staging/prod)
- [ ] 동적 설정 변경 API
- [ ] 설정 검증 및 백업

#### 6. 🔄 새로운 백엔드 추가
- [ ] OpenSearch 백엔드 구현
- [ ] Milvus 백엔드 구현
- [ ] Elasticsearch 백엔드 구현
- [ ] 백엔드 성능 비교 도구

### 🔷 LOW PRIORITY

#### 7. 🧠 임베딩 모델 성능 보완
- [ ] 감정 분석 모델 통합
- [ ] 동음이의어 감지 시스템
- [ ] 하이브리드 유사도 계산 시스템
- [ ] 임베딩 품질 평가 시스템

#### 8. 🌐 MCP (Model Context Protocol) 지원
- [ ] MCP 서버 구현
- [ ] 프로토콜 스펙 준수
- [ ] AI 모델 통합 인터페이스
- [ ] Claude/GPT 등 외부 모델 연동

#### 8. 🕷️ 웹 크롤링 & URL 기반 문서 수집
- [ ] **URL 크롤링 API** - `POST /v1/crawl/url`
  - [ ] 웹페이지 크롤링 (HTML 파싱, 텍스트 추출)
  - [ ] PDF 파일 다운로드 및 텍스트 추출
  - [ ] 이미지 파일 OCR 처리 (PNG, JPG, JPEG)
  - [ ] Office 문서 처리 (DOCX, PPTX, XLSX)
  - [ ] 텍스트 파일 처리 (TXT, MD, CSV)
  - [ ] 압축 파일 처리 (ZIP, RAR)
- [ ] **URL 검증 및 전처리**
  - [ ] URL 형식 검증 및 정규화
  - [ ] 리다이렉트 처리 및 최종 URL 추적
  - [ ] 접근 권한 확인 (robots.txt, 인증)
  - [ ] 파일 크기 제한 및 타임아웃 설정
- [ ] **콘텐츠 처리 파이프라인**
  - [ ] 메타데이터 추출 (제목, 작성자, 생성일)
  - [ ] 텍스트 정제 및 구조화
  - [ ] 자동 언어 감지
  - [ ] 청킹 및 벡터화
- [ ] **크롤링 관리 시스템**
  - [ ] 크롤링 작업 큐 및 스케줄링
  - [ ] 재시도 로직 및 오류 처리
  - [ ] 크롤링 히스토리 및 상태 추적
  - [ ] 동시 크롤링 제한 및 속도 조절
- [x] 중복 문서 감지 및 처리 - 파일 해시 기반 구현 완료

#### 9. 🔗 외부 데이터 소스 연계
- [ ] 공공 데이터 API 연계
- [ ] 외부 API 통합 프레임워크
- [ ] 데이터 소스 관리
- [ ] 자동 데이터 수집 및 업데이트

#### 10. 🤖 AI 에이전트 기능
- [ ] 질의응답 시스템
- [ ] 문서 요약 기능
- [ ] 자동 태깅 및 분류
- [ ] 지능형 검색 추천

## 🛠️ 기술적 개선사항

### 🔧 코드 품질 & 구조
- [ ] 의존성 주입 패턴 도입
- [ ] 코드 문서화 확장
- [ ] 타입 힌트 완성도 향상

### 🧪 테스트 시스템
- [x] **종합 테스트 스위트** - 82개 테스트 케이스, 100% 성공률 달성
- [ ] 단위 테스트 확장
- [ ] 부하 테스트 시나리오
- [ ] 테스트 데이터 관리
- [ ] CI/CD 파이프라인 통합

### 📦 배포 & 운영
- [ ] Docker 컨테이너화
- [ ] Kubernetes 배포 설정
- [ ] 환경별 배포 스크립트
- [ ] 로드 밸런싱 설정
- [ ] 백업 및 복구 전략

## 🎯 스프린트 계획

### 📋 Sprint 3: URL 크롤링 시스템 (다음 목표)
**예상 기간**: 2-3주
**우선순위 작업**:
1. [ ] **URL 크롤링 시스템** - 웹페이지, PDF, 이미지, Office 문서 지원
2. [ ] 고급 데이터 관리 API
3. [ ] 모니터링 & 분석 확장
4. [ ] 새 백엔드 추가 (OpenSearch, Milvus)

### 🔮 Sprint 4: AI 에이전트 & 확장 기능 (향후 계획)
**예상 기간**: 2-3주
**계획된 작업**:
1. [ ] MCP 프로토콜 지원
2. [ ] 크롤링 스케줄링 및 자동화
3. [ ] AI 에이전트 기능
4. [ ] 새 백엔드 추가 (OpenSearch, Milvus)
5. [ ] 배포 및 운영 최적화

## 📋 개발 가이드라인

### 코딩 원칙
- ✅ 기존 코드 스타일 유지
- ✅ 서비스 레이어 패턴 준수
- ✅ OpenAPI 스펙 완전 준수
- ✅ 에러 처리 및 로깅 표준화
- ✅ 통합 테스트 필수
- 🆕 성능 테스트 자동화
- 🆕 Storage 시스템 활용

### 우선순위 결정 기준
1. ✅ 핵심 RAG 기능 완성도 - **달성**
2. 🔄 사용자 경험 개선 - **진행 중**
3. ✅ 시스템 안정성 - **달성**
4. 🔄 확장성 및 유지보수성 - **진행 중**

## 📚 관련 문서

- [구현 상태](docs/IMPLEMENTATION_STATUS.md) - 완료된 기능 및 현재 상태
- [성능 지표](docs/PERFORMANCE_METRICS.md) - 성능 테스트 결과 및 벤치마크
- [아키텍처 가이드](docs/ARCHITECTURE_GUIDE.md) - 시스템 구조 및 설계 원칙

---

**마지막 업데이트**: 2025-07-13 - 테스트 시스템 개선 및 빈 파일 검증 추가
**다음 검토 예정**: Sprint 3 시작 시

## 🎉 최근 완료된 기능

### ✅ 종합 테스트 시스템 & 파일 검증 강화 (2025-07-13)
- **종합 테스트 스위트**: 82개 테스트 케이스로 모든 API 엔드포인트 검증
- **100% 테스트 성공률**: 모든 기능이 정상 작동 확인
- **빈 파일 거부 정책**: 검색 엔진 품질 향상을 위한 빈 파일 업로드 차단
- **특수 문자 처리**: JSON 이스케이프를 통한 제어 문자 검색 지원
- **성능 검증**: 모든 검색 유형 200ms 이하 응답 시간 달성
- **보안 테스트**: SQL 인젝션, XSS 공격 방어 검증
- **동시성 테스트**: 다중 요청 처리 안정성 확인

**테스트 범위**:
- 인증 및 권한 검사 (4개 테스트)
- 텍스트/벡터/하이브리드 검색 (20개 테스트)
- 파일 업로드 및 검증 (7개 테스트)
- 극한 상황 및 오류 처리 (15개 테스트)
- 성능 및 동시성 (10개 테스트)
- 특수 문자 및 보안 (20개 테스트)
- 응답 형식 검증 (6개 테스트)

### ✅ Rerank 시스템 (구현 완료)
- **Cross-encoder 모델**: `dragonkue/bge-reranker-v2-m3-ko` 한국어 특화 모델
- **API 엔드포인트**: `POST /v1/rerank`, `GET /v1/rerank/models`, `GET /v1/rerank/health`
- **캐싱 시스템**: 성능 최적화를 위한 결과 캐싱
- **배치 처리**: 다중 문서 동시 재순위화 지원
- **통합 검색**: 벡터/하이브리드 검색에서 자동 rerank 적용

**구현된 기능**:
- 검색 결과 품질 향상을 위한 Cross-encoder 재순위화
- 다양한 rerank 모델 지원 (BGE M3 KO, BGE Reranker, Custom)
- 하이브리드 검색에서 `rerank=true` 옵션으로 자동 적용
- 실시간 모델 상태 확인 및 헬스 체크

### ✅ 중복 문서 관리 시스템 (2025-07-13)
- **파일 해시 기반 중복 검사**: SHA-256 해시를 사용한 완전 동일 파일 검출
- **데이터베이스 스키마 확장**: file_hash, upload_count 필드 추가
- **자동 중복 처리**: 동일 파일 재업로드 시 기존 파일 참조 및 업로드 횟수 증가
- **API 응답 확장**: 중복 검사 결과 및 기존 파일 정보 포함
- **성능 최적화**: 파일 해시 인덱스 추가로 빠른 중복 검사

**구현된 기능**:
- 파일 업로드 시 실시간 중복 검사
- 메타데이터가 달라도 파일 내용이 같으면 중복으로 판단
- 중복 파일 발견 시 기존 파일 정보 반환 및 업로드 횟수 증가
- 임시 파일 자동 정리로 저장 공간 절약